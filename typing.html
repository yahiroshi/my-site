<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚­ãƒƒã‚ºã‚¿ã‚¤ãƒ”ãƒ³ã‚°</title>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #E0F7FA;
            --main-color: #4DD0E1;
            --text-color: #333;
            --accent-pink: #FF80AB;
            /* ç”»åƒã«åˆã‚ã›ãŸæŒ‡ã®è‰²å®šç¾© */
            --finger-blue: #81D4FA;   /* å·¦äººå·®ã—æŒ‡ */
            --finger-pink: #F48FB1;   /* å³äººå·®ã—æŒ‡ */
            --finger-green: #A5D6A7;  /* ä¸­æŒ‡ */
            --finger-yellow: #FFF59D; /* è–¬æŒ‡ */
            --finger-orange: #FFAB91; /* å°æŒ‡ */
        }

        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            user-select: none;
            padding-bottom: 50px; /* ä¸‹éƒ¨ã®ä½™ç™½ */
        }

        h1 {
            color: var(--main-color);
            font-size: 2.5rem;
            margin: 20px 0;
            text-shadow: 2px 2px #fff;
        }

        /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ */
        #menu-screen {
            text-align: center;
            margin-top: 50px;
        }

        .level-btn {
            display: block;
            width: 280px;
            margin: 20px auto;
            padding: 20px;
            font-size: 1.5rem;
            border: none;
            border-radius: 50px;
            background: white;
            box-shadow: 0 8px 0 #ddd;
            cursor: pointer;
            font-family: inherit;
            transition: transform 0.1s, box-shadow 0.1s;
            color: var(--main-color);
        }

        .level-btn:active {
            transform: translateY(4px);
            box-shadow: 0 4px 0 #ddd;
        }

        /* ã‚²ãƒ¼ãƒ ç”»é¢ */
        #game-screen {
            display: none;
            width: 90%;
            max-width: 850px; /* å…¨ä½“ã®å¹…ã‚’å°‘ã—åºƒã’ã¾ã—ãŸ */
            text-align: center;
            position: relative;
        }

        /* å˜èªè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .word-display {
            font-size: 5rem;
            margin: 20px 0;
            letter-spacing: 5px;
            background: white;
            padding: 20px;
            border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-height: 120px;
        }

        .char-correct { color: #ccc; }
        .char-current { color: var(--main-color); text-decoration: underline; }
        .char-future { color: #333; }

        /* --- å¤‰æ›´ç‚¹ã“ã“ã‹ã‚‰ --- */

        /* ä»ŠæŠ¼ã™ã¹ãæŒ‡ã®è‰²ã‚’è¡¨ç¤ºã™ã‚‹ãƒãƒ¼ */
        .finger-indicator {
            margin-top: 10px;
            font-size: 1.5rem;
            padding: 15px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å°‘ã—å¢—ã‚„ã—ã¾ã—ãŸ */
            border-radius: 20px; /* è§’ä¸¸ã‚’å°‘ã—å¤§ãã */
            font-weight: bold;
            color: #555;
            background: #eee;
            border: 5px solid transparent; /* æ ç·šã‚’å°‘ã—å¤ªã */
            
            /* æ¨ªå¹…ã‚’åˆã‚ã›ã¦åºƒã’ã‚‹è¨­å®š */
            width: 100%; 
            box-sizing: border-box;
        }

        /* ãƒ’ãƒ³ãƒˆç”»åƒã‚¨ãƒªã‚¢ */
        .hint-container {
            margin-top: 15px; /* ä¸Šã®ãƒãƒ¼ã¨ã®éš™é–“ã‚’èª¿æ•´ */
            position: relative;
            background: white;
            padding: 15px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å°‘ã—å¢—ã‚„ã—ã¾ã—ãŸ */
            border-radius: 25px; /* è§’ä¸¸ã‚’å°‘ã—å¤§ãã */
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            
            /* æ¨ªå¹…ã‚’åˆã‚ã›ã¦åºƒã’ã‚‹è¨­å®š */
            display: block; /* inline-blockã‹ã‚‰å¤‰æ›´ */
            width: 100%;
            box-sizing: border-box;
        }

        .hint-image {
            width: 100%; /* ç”»åƒã‚’ã‚³ãƒ³ãƒ†ãƒŠå¹…ã„ã£ã±ã„ã«åºƒã’ã‚‹ */
            height: auto;
            border-radius: 15px;
            display: block;
        }

        /* --- å¤‰æ›´ç‚¹ã“ã“ã¾ã§ --- */

        /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ */
        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .small-btn {
            background: #fff;
            border: 2px solid #ccc;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            font-size: 1rem;
        }

        .small-btn:hover { background: #f0f0f0; }

        /* çµæœç”»é¢ */
        #result-msg {
            font-size: 2rem;
            color: var(--accent-pink);
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,255,255,0.95);
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 100;
            width: 80%;
            max-width: 600px;
            text-align: center;
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .bounce { animation: bounce 0.3s; }

    </style>
</head>
<body>

    <h1>ğŸ° ã‚­ãƒƒã‚º ã‚¿ã‚¤ãƒ”ãƒ³ã‚° ğŸ»</h1>

    <div id="menu-screen">
        <button class="level-btn" onclick="startGame(1)">ãƒ¬ãƒ™ãƒ«1ï¼šA B C<br><small>ï¼ˆ1ã‚‚ã˜ï¼‰</small></button>
        <button class="level-btn" onclick="startGame(2)">ãƒ¬ãƒ™ãƒ«2ï¼šCAT DOG<br><small>ï¼ˆã‹ã‚“ãŸã‚“ï¼‰</small></button>
        <button class="level-btn" onclick="startGame(3)">ãƒ¬ãƒ™ãƒ«3ï¼šLION APPLE<br><small>ï¼ˆã™ã“ã—ãªãŒã„ï¼‰</small></button>
    </div>

    <div id="game-screen">
        
        <div class="controls">
            <button class="small-btn" onclick="toggleHint()">ãƒ’ãƒ³ãƒˆå›³ ON/OFF</button>
            <button class="small-btn" onclick="backToMenu()">ã‚„ã‚ã‚‹</button>
        </div>

        <div class="word-display" id="word-display">Waiting...</div>

        <div id="finger-msg" class="finger-indicator">
            ã“ã“ã‚’ã¿ã¦ã­ï¼
        </div>

        <div id="hint-box" class="hint-container">
            <img src="images-2.jpeg" alt="ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®æŒ‡é…ç½®å›³" class="hint-image">
        </div>

    </div>

    <div id="result-msg">
        ã‚„ã£ãŸã­ï¼ãœã‚“ã¶ã‚¯ãƒªã‚¢ï¼ğŸ‰<br>
        <button class="level-btn" onclick="backToMenu()" style="margin-top:20px;">ã‚‚ã©ã‚‹</button>
    </div>

<script>
    // --- éŸ³å£°æ©Ÿèƒ½ (Web Audio API) ---
    let audioCtx;
    function playSound(type) {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === 'suspended') audioCtx.resume();

        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        const now = audioCtx.currentTime;

        if (type === 'correct') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(1200, now);
            osc.frequency.exponentialRampToValueAtTime(1800, now + 0.1);
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            osc.start(now);
            osc.stop(now + 0.3);
        } else if (type === 'wrong') {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, now);
            osc.frequency.linearRampToValueAtTime(100, now + 0.2);
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.linearRampToValueAtTime(0, now + 0.2);
            osc.start(now);
            osc.stop(now + 0.2);
        }
    }

    // --- ãƒ‡ãƒ¼ã‚¿è¨­å®š ---
    const levels = {
        1: ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
        2: ["CAT", "DOG", "MOM", "DAD", "SUN", "RED", "FOX", "BOX", "ANT", "PIG", "EGG"],
        3: ["LION", "BEAR", "MILK", "BLUE", "PINK", "BIRD", "FISH", "JUMP", "BOOK", "TREE"]
    };

    const keyMap = {
        '1': 'orange', 'q': 'orange', 'a': 'orange', 'z': 'orange',
        '2': 'yellow', 'w': 'yellow', 's': 'yellow', 'x': 'yellow',
        '3': 'green', 'e': 'green', 'd': 'green', 'c': 'green',
        '4': 'blue', 'r': 'blue', 'f': 'blue', 'v': 'blue',
        '5': 'blue', 't': 'blue', 'g': 'blue', 'b': 'blue',
        '6': 'pink', 'y': 'pink', 'h': 'pink', 'n': 'pink',
        '7': 'pink', 'u': 'pink', 'j': 'pink', 'm': 'pink',
        '8': 'green', 'i': 'green', 'k': 'green', ',': 'green',
        '9': 'yellow', 'o': 'yellow', 'l': 'yellow', '.': 'yellow',
        '0': 'orange', 'p': 'orange', ';': 'orange', '/': 'orange', '-': 'orange'
    };

    const colorNames = {
        'orange': 'ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã®ã‚†ã³ï¼ˆã“ã‚†ã³ï¼‰',
        'yellow': 'ãã„ã‚ã®ã‚†ã³ï¼ˆãã™ã‚Šã‚†ã³ï¼‰',
        'green': 'ã¿ã©ã‚Šã®ã‚†ã³ï¼ˆãªã‹ã‚†ã³ï¼‰',
        'blue': 'ã¿ãšã„ã‚ã®ã‚†ã³ï¼ˆã²ã¨ã•ã—ã‚†ã³ï¼‰',
        'pink': 'ãƒ”ãƒ³ã‚¯ã®ã‚†ã³ï¼ˆã²ã¨ã•ã—ã‚†ã³ï¼‰'
    };

    const colorCodes = {
        'orange': '#FFAB91',
        'yellow': '#FFF59D',
        'green': '#A5D6A7',
        'blue': '#81D4FA',
        'pink': '#F48FB1'
    };

    // --- ã‚²ãƒ¼ãƒ çŠ¶æ…‹ ---
    let currentLevel = 1;
    let wordList = [];
    let currentWord = "";
    let charIndex = 0;

    // --- è¦ç´ å–å¾— ---
    const menuScreen = document.getElementById('menu-screen');
    const gameScreen = document.getElementById('game-screen');
    const wordDisplay = document.getElementById('word-display');
    const resultMsg = document.getElementById('result-msg');
    const hintBox = document.getElementById('hint-box');
    const fingerMsg = document.getElementById('finger-msg');

    // --- ã‚²ãƒ¼ãƒ é–‹å§‹ ---
    function startGame(level) {
        currentLevel = level;
        wordList = [...levels[level]].sort(() => Math.random() - 0.5).slice(0, 5);
        
        menuScreen.style.display = 'none';
        gameScreen.style.display = 'block';
        resultMsg.style.display = 'none';
        
        nextWord();
    }

    // --- æ¬¡ã®å˜èªã¸ ---
    function nextWord() {
        if (wordList.length === 0) {
            gameClear();
            return;
        }
        currentWord = wordList.pop();
        charIndex = 0;
        updateDisplay();
    }

    // --- ç”»é¢æç”» ---
    function updateDisplay() {
        let html = "";
        for (let i = 0; i < currentWord.length; i++) {
            const char = currentWord[i];
            if (i < charIndex) {
                html += `<span class="char-correct">${char}</span>`;
            } else if (i === charIndex) {
                html += `<span class="char-current">${char}</span>`;
                updateHint(char);
            } else {
                html += `<span class="char-future">${char}</span>`;
            }
        }
        wordDisplay.innerHTML = html;
    }

    // --- ãƒ’ãƒ³ãƒˆè¡¨ç¤º ---
    function updateHint(char) {
        const lowerChar = char.toLowerCase();
        const colorKey = keyMap[lowerChar];
        
        if (colorKey) {
            fingerMsg.style.borderColor = colorCodes[colorKey];
            fingerMsg.style.backgroundColor = colorCodes[colorKey] + "44";
            fingerMsg.innerText = `æ¬¡ã¯ã€Œ${char}ã€ï¼ ${colorNames[colorKey]} ã ã‚ˆ`;
        } else {
            fingerMsg.style.borderColor = "#ccc";
            fingerMsg.innerText = `ã€Œ${char}ã€ã‚’ãŠã—ã¦ã­`;
        }
    }

    // --- ã‚­ãƒ¼å…¥åŠ›å‡¦ç† ---
    document.addEventListener('keydown', (e) => {
        if (gameScreen.style.display === 'none') return;
        if (wordList.length === 0 && charIndex >= currentWord.length) return;

        const key = e.key.toUpperCase();
        const target = currentWord[charIndex].toUpperCase();

        if (key.length > 1) return;

        if (key === target) {
            playSound('correct');
            charIndex++;
            
            wordDisplay.classList.remove('bounce');
            void wordDisplay.offsetWidth;
            wordDisplay.classList.add('bounce');

            if (charIndex >= currentWord.length) {
                updateDisplay();
                setTimeout(nextWord, 500);
            } else {
                updateDisplay();
            }
        } else {
            playSound('wrong');
        }
    });

    // --- ãã®ä»–ã®æ©Ÿèƒ½ ---
    function toggleHint() {
        if (hintBox.style.display === 'none') {
            hintBox.style.display = 'block'; // inline-blockã‹ã‚‰å¤‰æ›´
        } else {
            hintBox.style.display = 'none';
        }
    }

    function gameClear() {
        playSound('correct');
        resultMsg.style.display = 'block';
    }

    function backToMenu() {
        menuScreen.style.display = 'block';
        gameScreen.style.display = 'none';
        resultMsg.style.display = 'none';
    }

</script>
</body>
</html>
